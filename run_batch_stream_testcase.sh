#!/bin/bash

# testDuration=180 #seconds => 3 minutes
# index=1
# classes=7
# duration=50
# predicate="E5.a == E6.a && E3.a == E4.a && E1.a + E2.a < 5"

# export MAX_MEMORY="4g"
# ln -s spec7.txt spec.txt


# rate=100
# inputEvents=$(( $rate * $testDuration ))
# testcase="testcase$index"
# index=$(( index + 1 ))
# echo "Rate: $rate"

# ./run_stream_testcase.sh $rate $inputEvents 1 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 2 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 3 $classes "$predicate" $duration
# mkdir Results/$testcase
# mv Results/OneState Results/AutomatonWithReuse Results/AutomatonWithNoReuse Results/$testcase

# rate=200
# inputEvents=$(( $rate * $testDuration ))
# testcase="testcase$index"
# index=$(( index + 1 ))
# echo "Rate: $rate"

# ./run_stream_testcase.sh $rate $inputEvents 1 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 2 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 3 $classes "$predicate" $duration
# mkdir Results/$testcase
# mv Results/OneState Results/AutomatonWithReuse Results/AutomatonWithNoReuse Results/$testcase

# rate=300
# inputEvents=$(( $rate * $testDuration ))
# testcase="testcase$index"
# index=$(( index + 1 ))
# echo "Rate: $rate"

# ./run_stream_testcase.sh $rate $inputEvents 1 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 2 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 3 $classes "$predicate" $duration
# mkdir Results/$testcase
# mv Results/OneState Results/AutomatonWithReuse Results/AutomatonWithNoReuse Results/$testcase

# rate=500
# inputEvents=$(( $rate * $testDuration ))
# testcase="testcase$index"
# index=$(( index + 1 ))
# echo "Rate: $rate"

# ./run_stream_testcase.sh $rate $inputEvents 1 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 2 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 3 $classes "$predicate" $duration
# mkdir Results/$testcase
# mv Results/OneState Results/AutomatonWithReuse Results/AutomatonWithNoReuse Results/$testcase

# rate=800
# inputEvents=$(( $rate * $testDuration ))
# testcase="testcase$index"
# index=$(( index + 1 ))
# echo "Rate: $rate"

# ./run_stream_testcase.sh $rate $inputEvents 1 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 2 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 3 $classes "$predicate" $duration
# mkdir Results/$testcase
# mv Results/OneState Results/AutomatonWithReuse Results/AutomatonWithNoReuse Results/$testcase

# rate=1000
# inputEvents=$(( $rate * $testDuration ))
# testcase="testcase$index"
# index=$(( index + 1 ))
# echo "Rate: $rate"

# ./run_stream_testcase.sh $rate $inputEvents 1 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 2 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 3 $classes "$predicate" $duration
# mkdir Results/$testcase
# mv Results/OneState Results/AutomatonWithReuse Results/AutomatonWithNoReuse Results/$testcase

# rate=1200
# inputEvents=$(( $rate * $testDuration ))
# testcase="testcase$index"
# index=$(( index + 1 ))
# echo "Rate: $rate"

# ./run_stream_testcase.sh $rate $inputEvents 1 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 2 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 3 $classes "$predicate" $duration
# mkdir Results/$testcase
# mv Results/OneState Results/AutomatonWithReuse Results/AutomatonWithNoReuse Results/$testcase

# rate=1500
# inputEvents=$(( $rate * $testDuration ))
# testcase="testcase$index"
# index=$(( index + 1 ))
# echo "Rate: $rate"

# ./run_stream_testcase.sh $rate $inputEvents 1 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 2 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 3 $classes "$predicate" $duration
# mkdir Results/$testcase
# mv Results/OneState Results/AutomatonWithReuse Results/AutomatonWithNoReuse Results/$testcase

# rate=2000
# inputEvents=$(( $rate * $testDuration ))
# testcase="testcase$index"
# index=$(( index + 1 ))
# echo "Rate: $rate"

# ./run_stream_testcase.sh $rate $inputEvents 1 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 2 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 3 $classes "$predicate" $duration
# mkdir Results/$testcase
# mv Results/OneState Results/AutomatonWithReuse Results/AutomatonWithNoReuse Results/$testcase

# rate=3000
# inputEvents=$(( $rate * $testDuration ))
# testcase="testcase$index"
# index=$(( index + 1 ))
# echo "Rate: $rate"

# ./run_stream_testcase.sh $rate $inputEvents 1 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 2 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 3 $classes "$predicate" $duration
# mkdir Results/$testcase
# mv Results/OneState Results/AutomatonWithReuse Results/AutomatonWithNoReuse Results/$testcase

# rate=5000
# inputEvents=$(( $rate * $testDuration ))
# testcase="testcase$index"
# index=$(( index + 1 ))
# echo "Rate: $rate"

# ./run_stream_testcase.sh $rate $inputEvents 1 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 2 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 3 $classes "$predicate" $duration
# mkdir Results/$testcase
# mv Results/OneState Results/AutomatonWithReuse Results/AutomatonWithNoReuse Results/$testcase

# rate=10000
# inputEvents=$(( $rate * $testDuration ))
# testcase="testcase$index"
# index=$(( index + 1 ))
# echo "Rate: $rate"

# ./run_stream_testcase.sh $rate $inputEvents 1 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 2 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 3 $classes "$predicate" $duration
# mkdir Results/$testcase
# mv Results/OneState Results/AutomatonWithReuse Results/AutomatonWithNoReuse Results/$testcase

# rate=20000
# inputEvents=$(( $rate * $testDuration ))
# testcase="testcase$index"
# index=$(( index + 1 ))
# echo "Rate: $rate"

# ./run_stream_testcase.sh $rate $inputEvents 1 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 2 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 3 $classes "$predicate" $duration
# mkdir Results/$testcase
# mv Results/OneState Results/AutomatonWithReuse Results/AutomatonWithNoReuse Results/$testcase

# cd Results
# mkdir 7classes
# mv testcase* 7classes/.
# cd ..

##################################################################

testDuration=180 #seconds => 3 minutes
index=1
classes=9
duration=50
predicate="E7.a == E8.a && E5.a == E6.a && E3.a == E4.a && E1.a + E2.a < 5"

export MAX_MEMORY="4g"
rm spec.txt
ln -s spec9.txt spec.txt


rate=10
inputEvents=$(( $rate * $testDuration ))
testcase="testcase$index"
index=$(( index + 1 ))
echo "Rate: $rate"

./run_stream_testcase.sh $rate $inputEvents 1 $classes "$predicate" $duration
./run_stream_testcase.sh $rate $inputEvents 2 $classes "$predicate" $duration
./run_stream_testcase.sh $rate $inputEvents 3 $classes "$predicate" $duration
mkdir Results/$testcase
mv Results/OneState Results/AutomatonWithReuse Results/AutomatonWithNoReuse Results/$testcase

rate=20
inputEvents=$(( $rate * $testDuration ))
testcase="testcase$index"
index=$(( index + 1 ))
echo "Rate: $rate"

./run_stream_testcase.sh $rate $inputEvents 1 $classes "$predicate" $duration
./run_stream_testcase.sh $rate $inputEvents 2 $classes "$predicate" $duration
./run_stream_testcase.sh $rate $inputEvents 3 $classes "$predicate" $duration
mkdir Results/$testcase
mv Results/OneState Results/AutomatonWithReuse Results/AutomatonWithNoReuse Results/$testcase

rate=30
inputEvents=$(( $rate * $testDuration ))
testcase="testcase$index"
index=$(( index + 1 ))
echo "Rate: $rate"

./run_stream_testcase.sh $rate $inputEvents 1 $classes "$predicate" $duration
./run_stream_testcase.sh $rate $inputEvents 2 $classes "$predicate" $duration
./run_stream_testcase.sh $rate $inputEvents 3 $classes "$predicate" $duration
mkdir Results/$testcase
mv Results/OneState Results/AutomatonWithReuse Results/AutomatonWithNoReuse Results/$testcase

rate=50
inputEvents=$(( $rate * $testDuration ))
testcase="testcase$index"
index=$(( index + 1 ))
echo "Rate: $rate"

./run_stream_testcase.sh $rate $inputEvents 1 $classes "$predicate" $duration
./run_stream_testcase.sh $rate $inputEvents 2 $classes "$predicate" $duration
./run_stream_testcase.sh $rate $inputEvents 3 $classes "$predicate" $duration
mkdir Results/$testcase
mv Results/OneState Results/AutomatonWithReuse Results/AutomatonWithNoReuse Results/$testcase

rate=80
inputEvents=$(( $rate * $testDuration ))
testcase="testcase$index"
index=$(( index + 1 ))
echo "Rate: $rate"

./run_stream_testcase.sh $rate $inputEvents 1 $classes "$predicate" $duration
./run_stream_testcase.sh $rate $inputEvents 2 $classes "$predicate" $duration
./run_stream_testcase.sh $rate $inputEvents 3 $classes "$predicate" $duration
mkdir Results/$testcase
mv Results/OneState Results/AutomatonWithReuse Results/AutomatonWithNoReuse Results/$testcase

rate=100
inputEvents=$(( $rate * $testDuration ))
testcase="testcase$index"
index=$(( index + 1 ))
echo "Rate: $rate"

./run_stream_testcase.sh $rate $inputEvents 1 $classes "$predicate" $duration
./run_stream_testcase.sh $rate $inputEvents 2 $classes "$predicate" $duration
./run_stream_testcase.sh $rate $inputEvents 3 $classes "$predicate" $duration
mkdir Results/$testcase
mv Results/OneState Results/AutomatonWithReuse Results/AutomatonWithNoReuse Results/$testcase

rate=200
inputEvents=$(( $rate * $testDuration ))
testcase="testcase$index"
index=$(( index + 1 ))
echo "Rate: $rate"

./run_stream_testcase.sh $rate $inputEvents 1 $classes "$predicate" $duration
./run_stream_testcase.sh $rate $inputEvents 2 $classes "$predicate" $duration
./run_stream_testcase.sh $rate $inputEvents 3 $classes "$predicate" $duration
mkdir Results/$testcase
mv Results/OneState Results/AutomatonWithReuse Results/AutomatonWithNoReuse Results/$testcase

rate=500
inputEvents=$(( $rate * $testDuration ))
testcase="testcase$index"
index=$(( index + 1 ))
echo "Rate: $rate"

./run_stream_testcase.sh $rate $inputEvents 1 $classes "$predicate" $duration
./run_stream_testcase.sh $rate $inputEvents 2 $classes "$predicate" $duration
./run_stream_testcase.sh $rate $inputEvents 3 $classes "$predicate" $duration
mkdir Results/$testcase
mv Results/OneState Results/AutomatonWithReuse Results/AutomatonWithNoReuse Results/$testcase

rate=1000
inputEvents=$(( $rate * $testDuration ))
testcase="testcase$index"
index=$(( index + 1 ))
echo "Rate: $rate"

./run_stream_testcase.sh $rate $inputEvents 1 $classes "$predicate" $duration
./run_stream_testcase.sh $rate $inputEvents 2 $classes "$predicate" $duration
./run_stream_testcase.sh $rate $inputEvents 3 $classes "$predicate" $duration
mkdir Results/$testcase
mv Results/OneState Results/AutomatonWithReuse Results/AutomatonWithNoReuse Results/$testcase

# rate=3000
# inputEvents=$(( $rate * $testDuration ))
# testcase="testcase$index"
# index=$(( index + 1 ))
# echo "Rate: $rate"

# ./run_stream_testcase.sh $rate $inputEvents 1 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 2 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 3 $classes "$predicate" $duration
# mkdir Results/$testcase
# mv Results/OneState Results/AutomatonWithReuse Results/AutomatonWithNoReuse Results/$testcase

# rate=5000
# inputEvents=$(( $rate * $testDuration ))
# testcase="testcase$index"
# index=$(( index + 1 ))
# echo "Rate: $rate"

# ./run_stream_testcase.sh $rate $inputEvents 1 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 2 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 3 $classes "$predicate" $duration
# mkdir Results/$testcase
# mv Results/OneState Results/AutomatonWithReuse Results/AutomatonWithNoReuse Results/$testcase

# rate=10000
# inputEvents=$(( $rate * $testDuration ))
# testcase="testcase$index"
# index=$(( index + 1 ))
# echo "Rate: $rate"

# ./run_stream_testcase.sh $rate $inputEvents 1 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 2 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 3 $classes "$predicate" $duration
# mkdir Results/$testcase
# mv Results/OneState Results/AutomatonWithReuse Results/AutomatonWithNoReuse Results/$testcase

# rate=20000
# inputEvents=$(( $rate * $testDuration ))
# testcase="testcase$index"
# index=$(( index + 1 ))
# echo "Rate: $rate"

# ./run_stream_testcase.sh $rate $inputEvents 1 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 2 $classes "$predicate" $duration
# ./run_stream_testcase.sh $rate $inputEvents 3 $classes "$predicate" $duration
# mkdir Results/$testcase
# mv Results/OneState Results/AutomatonWithReuse Results/AutomatonWithNoReuse Results/$testcase

cd Results
mkdir 9classes
mv testcase* 9classes/.
cd ..
